<?phpfunction realDeleteComment($usr, $id, $page, $delete = false){	$requeteDone = '';	$dbVars = setDbVars(getStatus());		$req = 'SELECT * FROM `'.$dbVars['DbName'].'`.`'.$dbVars['DbPrefix'].'comment` WHERE `service_id`='.$usr['noService'].' AND id='.$id.' LIMIT 1;';	$res = query($req, $usr);	if($res != null && mysql_num_rows($res) != 0){		$commentVal = mysql_fetch_array($res, MYSQL_ASSOC);				if(codeToRessourceType($commentVal['elt_type']) == 'quote'){ // diminution du compteur de la citation			$req = "UPDATE `".$dbVars['DbName']."`.`".$dbVars['DbPrefix']."quote` SET comments=comments-1 WHERE `service_id`='".$commentVal['service_id']."' AND id=".$commentVal['elt_id'].";";			if($delete == true){query($req, $usr);}			$requeteDone .= $req.'<br/>';		}		if($commentVal['vote_up'] != 0 || $commentVal['vote_down'] != 0){ // suppression des votes pour ce commentaire			$req = "DELETE FROM `".$dbVars['DbName']."`.`".$dbVars['DbPrefix']."vote` WHERE service_id='".$commentVal['service_id']."' AND elt_type=3 AND elt_id='".$id."';";			if($delete == true){query($req, $usr);}			$requeteDone .= $req.'<br/>';		}		if($commentVal['reported'] != 0){ // suppression des signalements pour ce commentaire			$req = "DELETE FROM `".$dbVars['DbName']."`.`".$dbVars['DbPrefix']."reported` WHERE service_id='".$commentVal['service_id']."' AND elt_type=3 AND elt_id='".$id."';";			if($delete == true){query($req, $usr);}			$requeteDone .= $req.'<br/>';		}		$req = "DELETE FROM `".$dbVars['DbName']."`.`".$dbVars['DbPrefix']."comment` WHERE service_id='".$commentVal['service_id']."' AND id='".$id."';";		if($delete == true){query($req, $usr);}		$requeteDone .= $req.'<br/>';			}		return $requeteDone;}function realDeletQuote($usr, $id, $page, $delete = false){	$requeteDone = '';		$req = 'SELECT * FROM `'.$dbVars['DbName'].'`.`'.$dbVars['DbPrefix'].'quote` WHERE `service_id`='.$usr['noService'].' AND id='.$id.' LIMIT 1;';	$res = query($req, $usr);	if($res != null && mysql_num_rows($res) != 0){		$commentVal = mysql_fetch_array($res, MYSQL_ASSOC);						if($commentVal['comments'] != 0){ // suppression des commentaires pour cette citation			$req = 'SELECT id FROM `'.$dbVars['DbName'].'`.`'.$dbVars['DbPrefix'].'comment` WHERE `service_id`='.$usr['noService'].' AND elt_type=2 AND elt_id='.$id.';';			$res = query($req, $usr);			if($res == null || mysql_num_rows($res) != $commentVal['comments']){				$requeteDone = 'Incoh√©rence dans le nombre de commentaires !!!<br/>Veuillez corriger cette erreur avant de supprimer la citation !';			}			else{				while($ret = mysql_fetch_array($res, MYSQL_ASSOC)){					$requeteDone .= realDeleteComment($usr, $ret['id'], $page, $delete);				}			}		}		if($commentVal['vote_up'] != 0 || $commentVal['vote_down'] != 0){ // suppression des votes pour cette citation			$req = "DELETE FROM `".$dbVars['DbName']."`.`".$dbVars['DbPrefix']."vote` WHERE service_id='".$commentVal['service_id']."' AND elt_type=2 AND elt_id='".$id."';";			if($delete == true){query($req, $usr);}			$requeteDone .= $req.'<br/>';		}		if($commentVal['reported'] != 0){ // suppression des signalements pour cette citation			$req = "DELETE FROM `".$dbVars['DbName']."`.`".$dbVars['DbPrefix']."reported` WHERE service_id='".$commentVal['service_id']."' AND elt_type=2 AND elt_id='".$id."';";			if($delete == true){query($req, $usr);}			$requeteDone .= $req.'<br/>';		}				$req = "DELETE FROM `".$dbVars['DbName']."`.`".$dbVars['DbPrefix']."suivi` WHERE service_id='".$commentVal['service_id']."' AND elt_type=2 AND elt_id='".$id."';";		if($delete == true){query($req, $usr);}		$requeteDone .= $req.'<br/>';				$req = "DELETE FROM `".$dbVars['DbName']."`.`".$dbVars['DbPrefix']."category_quote` WHERE service_id='".$commentVal['service_id']."' AND quote_id='".$id."';";		if($delete == true){query($req, $usr);}		$requeteDone .= $req.'<br/>';				$req = "DELETE FROM `".$dbVars['DbName']."`.`".$dbVars['DbPrefix']."selection_quote` WHERE service_id='".$commentVal['service_id']."' AND quote_id='".$id."';";		if($delete == true){query($req, $usr);}		$requeteDone .= $req.'<br/>';				$req = "DELETE FROM `".$dbVars['DbName']."`.`".$dbVars['DbPrefix']."quote` WHERE service_id='".$commentVal['service_id']."' AND id='".$id."';";		if($delete == true){query($req, $usr);}		$requeteDone .= $req.'<br/>';			}		return $requeteDone;}?>